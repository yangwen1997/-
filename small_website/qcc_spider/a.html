print(html_text.text)
<div style="position: fixed; z-index: 2000; top: 0px; left: 0px; right: 0px; bottom: 0px; background: #fff; " class="guquan-liframe"></div> <div class="guquan-lnodata pnodata lg" style="display: none;"> <img src="/material/theme/chacha/cms/v2/images/nno_image.png"> <p>没有找到相关数据</p> </div> <!--[if lt IE 9]>
    <link rel="stylesheet" href="/material/theme/chacha/cms/v2/css/app_ie8.css?time=1508428800" type="text/css" />
    <script src="/material/theme/chacha/cms/v2/js/html5shiv.js"></script>
    <script src="/material/theme/chacha/cms/v2/js/respond.js"></script>
    <![endif]--> <style type="text/css">
    .water-mark{
        bottom: 0px !important;
        padding-bottom: 5px;
        background: rgba(255,255,255,.85);
    }
</style> <!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> <meta name="renderer" content="webkit"> <meta name="author" content="leslie"> <title>公司股权穿透-企查查</title> <meta name="keywords" content="企查查,企业查询,公司查询,工商查询,企业信用信息查询系统,企业工商信息查询平台,企业财务信息查询,企业信用评价查询,企业纠纷查询,企业现金流查询,企业股权查询,企业负债查询,企业资产查询,企业财报查询,企业失信信息查询,启信宝,天眼查,天眼通"> <meta name="description" content="企查查信息来自国家企业信用信息公示系统，提供企业信息查询,工商查询,企业信用评价查询，企业纠纷查询，企业现金流查询，企业股权查询，企业负债查询，企业资产查询，企业财报查询,公司查询等相关信息查询；帮您快速了解企业信息,企业工商信息,企业信用信息等经营和人员投资状况！"> <link rel="icon" href="/material/theme/chacha/cms/v2/images/favicon.png"> <link rel="stylesheet" href="/material/theme/chacha/cms/v2/css/bootstrap.css" type="text/css" /> <link rel="stylesheet" href="/material/theme/chacha/cms/v2/css/font-awesome.min.css" type="text/css" /> <link rel="stylesheet" href="/material/theme/chacha/cms/v2/css/icon.css" type="text/css" /> <link rel="stylesheet" href="/material/theme/chacha/cms/v2/css/font.css" type="text/css" /> <link rel="stylesheet" href="/material/theme/chacha/cms/v2/css/app.css?time=1562322400" type="text/css" /> <link rel="stylesheet" href="/material/theme/chacha/cms/v2/css/common.css?time=1562322400" type="text/css" /> <link rel="stylesheet" href="/material/theme/chacha/cms/pro/css/simple-line-icons.css" type="text/css" /> <script type="text/javascript">
    window.iframe = true;
</script> <script type="text/javascript" src="/material/js/siteconfig.js?time=1562322400"></script> <script src="/material/theme/chacha/cms/v2/js/jquery.min.js"></script> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/qrcode.min.js"></script> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/jquery.scrollTo.js"></script> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/jquery.qrcode.min.js"></script> <script src="/material/theme/chacha/cms/v2/js/bootstrap.js"></script> <script type="text/javascript" src="/material/js/echarts.min.js"></script> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/china.js?time=1508428800"></script> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/chartsUtil.js?time=1562322400"></script> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/kslide.js?time=1562322400"></script> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/searchList.js?time=1562322400"></script> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/phoneSelect.js?time=1562322400"></script> <script src="/material/theme/chacha/cms/v2/js/slimscroll/jquery.slimscroll.min.js"></script> <link rel="stylesheet" href="/material/theme/chacha/cms/v2/css/toastr.css?time=1562322400" /> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/moment.js"></script> <script src="/material/theme/chacha/cms/v2/js/toastr.js" type="text/javascript"></script> <script src="/material/theme/chacha/cms/v2/js/custom.js?time=1562322400"></script> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/zhuge.js?time=1562322400"></script> <script type="text/javascript">
        var userId = '';
    var userGroupid = '';
    var freeCompanies = ["11bfc286c652853bff093eb876e5ff15","f7e43ccd3965149b5be8fffc94a94d77","273815ac184c84831d236f248a2033d5","6224352030ad2c50884f424f71f0babc","4c3ceb32401fb0fd10fd658208491214","3343e4b5df4fe867c130cf6311fb572f","e06ec146e20d7cbb267d4edb71c1a4be","ecbd5d14327c6e491cdca1ecc4193c3e","8b0180ffb9a8d9d818d8c70073dd1533","8e7de5bd759b103b2ec65419f0679d87","6598280c8903cfc6404f94f30976b3ba","85ea186b347d96626083efe111aaafeb","b937ed945640f6f0c4d9e2023b109379","6d5107a8707406cbb4836fb29ef88e7d","3065012a7bc3f9583a8d09fb9d2f38b8","c1127ec9eaf4faa3f31d17bf7c90adf8","c57a9bba7dd591ca78a67beee385bde0","19e04b5660c60f271e8e9ebcab490faf","84a3f1dc246131bd0410a1fd9d384460","a58533710987ecf98159545b61505a74","5e0f1e8b864ffbffd3b78eea10961487","127fcf53de2598be86ab1b3cad165cf1","9a3c22dfce58dfd8090d59451971229c","e3e9456716828b1582b34ec25f7dd2e7","9cce0780ab7644008b73bc2120479d31","10f538f5dca9fde373612ff44d231d20","7d294eaabd0bb9b1f316026d4856b41a","2b6d4910b7514255bb43c36c170e48e3","815c4b7bca5e74db130b992ea2bc1b88","bc740f75e5e9b948151f5c608f33030c","a6dc74fe485c730bc0c71f84ddb4e3a6","669b7e5de0c437f21b10ddc4d70f4360","59a1bc8739127dff9ea7e58a8280c4ae","e45ee37279ffb3f2ce9bbbcfa39d8133","d2f8562b4fc953539f8e926b8f3f2f08","18ff2c7ad1d11bfe40e0bec84f6d04d3","c9a132f0702d1d7fcb4895673a55f426","84c17a005a759a5e0d875c1ebb6c9846","90d3ff3169f1200ef62d78034df9c54e","7bd0ef47b296f6dd1ea330751bf56612","cfe8879a8664ad3a373a103e9b5cc526","c70a55cb048c8e4db7bca357a2c113e0","b70a10f461272c5b5ed3d2b8d2b03f69","a74fc07ca4735f8d8bdd3fbee0c6f6c0","fab96b719ef6387bd9d095bec03de3f0","9cce0780ab7644008b73bc2120479d31"];
    var freePeople = ["p441efd3807a065c24de74b5b4be3b5d","pbd14c1a830af087a22e664b211111a2","p089070bd9e914e774ef3e95d00ec5b0","p443d6a190278796f7930982dfe73f42","p202afa75ec282beabae2dd5d1f8e521","p2f4391f2600fcc10442c8f22606be20","p146c9f00d63c0fc5e1d4634c917889e","peff4efbd8aaa94d852a42d6bd4f622e","pd260c6712ed49ee88504a64c5ed9482","p347ca283005d596e26b5705fe3e5424","p25fe19b03899303d307235eaa471916","pr51b8951f1049973a8ba758266b6779","p871b2ad73b8b07e3997b0db7fcf9772","p9fa343b3bb5216b246c72aeb77bce0c","p67d2355b8ca06b442eda7b5a55b4803","p226df53c2baa849d6934a9089085ebf","pc0afc496a38fb16121ba654241bee5b","pc4a47cfe2e67199a3c45d9f8c40e1c0","p593208d3aa8e49707325de214a8cb60","p557b82fef8b08e481aadb65085b008b","p04609ece9fe504be41433742c1bf3eb","p522e021cee9336bfb6097250baa3e1b","p568dbf4e82ed6effd2ea1682c7943b8","p089070bd9e914e774ef3e95d00ec5b0","p3483c261f318de061fb3ded0508bf90","p82222ef85bfd379a8e5226dadc543dd","p684b3f0c79b5dfe6d8a290ba66e798a","pc4eb763297cf4b8076c2e0d2fe64617","p287aa836f4e2c3c6597d09f37731f85","p858a1f2f2e7864fac8d3acce4c8bb8f","p8cb6c16db2ea8fac8ecaadefe35ff8b","p6b2cf613dd4772da8ff3a9575eec8bf","p0b1f20c4c28963ace6eff596cbb7214","pfd208a680dc4871736b7001274ba8f0","pdd3325c48473fcd64180921d82ead80","pbbefb7a246f4e86a033713e889f9674","pe366442cb673caf54889e6df853e0c0","pf6ea929da129db627bfcf9bf48edc65","p1856f2582e91cf6869be9652cf91512","pde0ba11f9cc81e8e22b89d378dd597b","pc127c37072772dabd4865bd62459891","pe919b2bf2e9c6cdd24d8b63f5969fdd","p1db0b9e274d3e70dd9a2334ad82b93b","p38b6a9f4201932948f613f90ab24cdd","p0e6f9e9a26a0e41c4a3f9be7c062ef2","p9070853c3d33d38134c64a156989284","pbccd0d3eb5ada9952e52772f9e54ebe","p79bb7b0dd3f36e6e5f5100c4e3235a9","pr9c47cb6b2a96048c1d49d1ec72b3c7","p89c2161a36e89cd81bc47424c28ae5b","pae9614885f6fe1df986a5657337915a","pd24f0e6c29ec7afe56cac57d665a70b","p32d88b0b48cd2bbcd9d4f29b1b1670d","p7b171afb629657b151c43bf3e718155","p375870fa646d110dde4fbe356f1913e","p0d43bf24ced3d482947792b410b3892","p2766646c26fb8bf53f01c17c0cd1a7e","peabcad582bff5cc35feddb8a2dca458","p9e7818eb8ffc10380ddeb37549c3594","p62f5e7603c2870f0316e439db89d33e","p8bb365678cceb173c3f6645fac32463","pd7d02c68b11c928bc5c5f3f68a43bd8","pd99973e6e867199057f35891f10ece9","p5bc1e3c3f62ed3437786bc969600b9a","pdc2b7a3cc2c414b3910a1d9e116567a","pa884808a0e7526dd17a682739cb38ec","p0b093ef01998ca26f345d4231003a9b","p6abbf243fc5557f96d4488fde8a89f5","pa85a527d51f75da260083b1cf98da24","p24129f60d16a9d20e70f29452341dec","p507f1693d86036364ec3b5b4d3c0639","p60d00d52bf712741e2fc7f435a31302","p4609f5b766b75d4ab09180fa954da02","p6da28fd74891226f20838f3900fad36","pa43fd5c3172044465f25069df6e61b8","pbfd190fa68be5988ff53ae9c1fb75e7","p189c9b0f7e004118b9484f47e6cda68","pcbfd37ad2a2598da9a6b5de289835dd","p96fe6a8b395b31912ecb7e1f41f23b0","pea5ac417585edc0effd7d23406510da","pd57e12ca20e0096dfea61993dfe48f8","p03cf330a686332cfe9cb8f36a8f3ab8","p8ca4283fb80cf988920545e99aef3a4","p1910534b4ae98fea35ddbeb1d61cd44","pf3b1bf00922bac873eec7950cecec88","pb5d99e1912cf2b87f96c7fdaa129ebe","pb6f2f51a297e57acd8a8a161a6a28bc","p131e16ad01343fa580933ad37cd33cb","p70e7789ba2d4e8172cc4fec474711fb","p6609596e149d5bc0201a0b9f4e4fcb7","pb7beff14c56b6f216f92ad95d874f51","pad06603add12c231e78caab20a05f6c","p411cb5d3d6a3399aa210df8845090ea","pf614487a898ad76c39ec0fc65ec3d4f","p954d6bbb51b05a8b3f91e51e79901a9","p5b288352cf3b9499b9271bf888008df","p0ca25440e7114c5974d01d583e52b00","pc747a2d6aaa24efad55793147bc7987","p2a2c9a1417dfff19e607aa3b30787b9","p44cb4832f4146f286a2c5c4ab4ef673","p7cb6f77da9f15766cb65765761c9d19","p38bfd08992f02ba2a136ca892d62899","pd05b697b081dcb4e66719032c2cc760","p61fbfc3a108d8efaf565de1306e23a0","p21c63257afca04e61ff32ac5580572a","p1ec3c35fa9051d8723047b80453ae69","p9d9efeb5aa665dbe66525ced8158f90","pb0489d8530decee9a061f3be5732844","p4bcf05c17b1b0918890fe3a5e64d41f","pfa52806be628929568e0dcbd943d57e","p18da2d9c2244c6dba4180f0d38a7716","p30833a0589ab2f56f93bd113bbaf9bd","pdd9194581da5dda4f700baebc44cc31","pf21af25ef345c47daa9e738732edfa6","pe553922ca919d6a7258c4056e2ab6b7","p7737993e45432ed0e721b28267e058a","p6fb279283ceeba19fe9e85acf4c1f7e","p784a2184d94be1818b6d522b5c8a9d9","pd9751940a8bdcf373ae27804f29c12a","pa313dc90dffce21f98187ca8b1eaa15","p8c945c9f031c2fa391208aeb9a63777","pf1e6aed975eb577cb46d51ac7ec3f14","p91f92d0f783be4faba5935904f6e2e1","pb85b223185323f8cc668b7146ddaba9","p4b2c9d74f0a53dc7834fb9aaed58bfd","p84c368f313b4d0808e3fb8ca36e10ad","p917b446e33f719e683fa127465c03bc","p14811e6d3e3c6380ce34dc64d6bb0c2","p325ad0d3c574b124e802f3ad612b7bd","pb46f67ed928d48c6f59af057ca64fcf","pc5e58ea25a0966d860efa862e64a4b3","p0cf2da4ed6ccd9fff31cd232bd3a795","p2bf510b2944458716d0a263913866f1","p2bfa369c340fc42e4c408a98f0a1f26","p4f92d97100bd868d73fa62e9ce00b28","p592a5a06fd6d1ffa4a204e0c499de24","pa289f26dbfa128c37beb57b793edc79","pf410cc5e6bf73d7a117de49a7b1af5e","p2c045fc38d5bec1d438cc581e0f86a4","p89043bad02f62e899855bceb1f7c71b","pr4c963d26e89c8fff17daf449668e16","p8cf7445cd8c5956c7480f1d507b2cd1","p885609c358d14e07fd99d41ed314e99","p57180cc2a70271694f52740d0d9ae1b","p4a6bb86866883881d5f7005f861f7a4","p57153b6ab8750d1dfd32b0c56f398d1","p556225ea3e000a06e4a35f2bdf18481","p1c907e22aaff36740ea8f603b901b32","p412cd235e5252a1c8b90705bf19fbcb","p0b9468faca13fb6100df091d20297f1","pb4e17e90f7c1cfa54560ac4fe041db6","p6c7313d1a025112e8778dfeedc0ffe1","pc491219acf1f61a59c04dea39bedfa5","p5bb4cb536f8904b937650ecbac0b94a","p26b2932ed1a63519bb81e44ba8c104c","pd3f1646db9a01cea29c61c33b9ee617","p64df099fa4661b4d400c5896a39681b","pd923a5cc21dfac7fdbf9dfa9c6fa533","pc97d58fb9ac9bd3836bbe07fdd2735a","p0248c4f7a28bc236748fc4610b5ef1d","p4caa8eb789c5d0fe7d6a88b0dc9000c","p4f2b6e1ae6b40edafecde1c73e85cd2","pad4ad4c3b995c633a39ae06c899f18a","p056aab2e73f92dbcebd51da8111c1ac","pr894be363cef980d10af39d88a85398","p0794177a7df688a3c779b7408edebf0","pf9ec94f17dc07af1ecd3409f3523f6d","pbb6cbd616af10953b12db428bd7af9d","p7e22dafa4d6ee1193820480fed43953","p067936c7397b739ec6b0d297b95ec06","pr0a8298f7c230bf5fc40124625a7d1c","p8718f47f94756d94d3933ea806b76c3","p627634414f75aa172f1623c6d909bb5","pfe71e70a5951f48e2d6be8134a69ab9","p418e3e56998a8e8237a551840a9976d","pa8379689f22cb9c588dadacbac3bd90","p3a8634f7b3ad183f6f31b9123868dce","pr796baa55fffb4891c66c5cadf93242","p686bfc2eccc4011491c9a1ddbc7609e","p1b1e565d80a051007b8d18f17e07e05","p9a719fb3a18f289340fd0c43c356839","p91e374fa50b4648e9911d941ece2b82","p824b008f59b9e5d89842ea9bd529587","pff44c7629a4b0a2bf96eea21a63f1f7","p3fb6d0bed1bd2c96b172f77c97846f4","p1fdaf8e212811fb8edd33781d84b24d","p4150ff74059ca6c582cb6151ff9718b","p10ff32f62339a56dee86d3a362ee8b2","pf28d61dd4cd96570757734940a28c55","pr0ac1235cf5613a979f9c28dc920302","p436160a297843d6312902a0049665d1","p196fb6607ce39e7e2156b254a9e54d0","p283698248c8c18693974f0ed8e2c488","p1910534b4ae98fea35ddbeb1d61cd44"];
</script> <script type="text/javascript">
        var qrcodePolling = false;
    </script> </head> <body> <header class="header navi-header box-shadow "> <div class="container "> <div class="navi-brand"> <a onclick="zhugeTrack('主页-顶部-logo');" href="/" > <img src="/material/theme/chacha/cms/v2/images/logo4.png" class="m-r-sm" alt="企查查"> </a> </div> <form class="navi-form" role="search" action="
                /search"> <div class="form-group"> <div class="input-group"> <a id="clearSearchkey" class="clear-searchkey"></a> <input id="headerKey" name="key" class="form-control headerKey" style="font-size: 14px;" type="text" placeholder="请输入企业名称、人名，产品名等，多关键词用空格隔开，如“小米 雷军”" value="" autocomplete="off"> <span class="input-group-btn" style="float: left"> <button onclick="" type="submit" class="btn btn-primary top-searchbtn"></button> </span> </div> </div> <section class="panel headerKey header-section" id="header-search-list"></section> </form> <script type="text/javascript">
                    $('#headerKey').searchList({
                        list:'#header-search-list',
                        clear:'#clearSearchkey',
                                            });
                </script> <script type="text/javascript">
                var pathname_ = window.location.pathname;
                if(pathname_ == '/search_riskinfo' || pathname_ == '/search_intellectualinfo'){
                    $('#tpsearch').attr('action', pathname_);
                }
            </script> <ul class="navi-nav pull-right"> <li> <a onclick="zhugeTrack('主页-顶部-APP下载');" href="/app" class="dropdown-toggle header-qrcode">
                    APP下载
                  </a> <section class="dropdown-menu qrcode-box"> <img src="/material/theme/chacha/cms/v2/images/header_qrcode@2x.png?t=3"> </section> </li> <li class="head-line">|</li> <li class=""> <a onclick="zhugeTrack('主页-顶部-VIP服务');" href="/vip">VIP服务</a> </li> <li class="head-line">|</li> <li><a onclick="" href="/user_login?back=%2Fcompany_guquan%3FkeyNo%3D8c7d3eb4737848039633ebcd9dc47270%26iframe%3D1">登录</a></li> <li  class="head-line">|</li> <li> <a onclick="" href="/user_register">免费注册</a> </li> </ul> </div> </header> <script type="text/javascript" src="/material/js/jquery.cookie.js"></script> <script type="text/javascript" src="/material/js/jquery.validate.min.js"></script> <script type="text/javascript" src="/material/js/jquery.form.min.js"></script> <script type="text/javascript" src="/material/js/global.js?t=1562322400"></script> <link rel="stylesheet" href="/material/theme/chacha/cms/v2/css/companyDetail.css?time=1562569564" type="text/css" /> <style type="text/css">
    html,body{
        height: 100%;
        background-color: #fff;
    }

    .mao-main{
        width: 100%;
    }
    .stock-name{
        color: #fe5151;
    }
    .water-mark{
        position: absolute;
        z-index: 15;
        font-size: 12px;
        color: #aaa;
        text-align: center;
        width: 100%;
        bottom: 20px;
    }
    .bsBox, .bsBox *{
        box-sizing:content-box;
    }

</style> <div class="mao-head whitebg"> <div class="container"> <ul class="mao-title breadcrumb" style="background:none;border:none;"> <li> <a href="/firm_8c7d3eb4737848039633ebcd9dc47270.html"> <img src="/material/theme/chacha/cms/v2/images/ic_reply.png"> <a class="text-primary" href="/firm_8c7d3eb4737848039633ebcd9dc47270.html"> </a> </a> </li> </ul> <ul id="navTab" class="mao-nav"> <li class=""><a onclick="" href="/company_businessmap?keyNo=8c7d3eb4737848039633ebcd9dc47270&name=">企业图谱</a></li> <li class=""><a onclick="" href="/company_muhou3?keyNo=8c7d3eb4737848039633ebcd9dc47270&name=">关联图谱</a></li> <li class="active"><a onclick="" href="/company_guquan?keyNo=8c7d3eb4737848039633ebcd9dc47270&name=">股权穿透图</a></li> <li class=""> <a onclick="showVipModal('疑似实际控制人','成为VIP会员即可查看疑似实际控制人  总股权比例等信息','');">疑似实际控制人</a> <span class="ntag vip m-l-sm" data-trigger="hover" data-html="true" data-toggle="tooltip" data-placement="bottom" data-delay="500" title="尊敬的会员，您正在使用高级特权">功能</span> </li> </ul> </div> </div> <div class="mao-loading" id="load_data"> <img src="/material/theme/chacha/cms/v2/images/preloader.gif"> </div> <div class="mao-nodata" id="no_data"> <div class="guquan-lnodata pnodata"> <img src="/material/theme/chacha/cms/v2/images/nno_image.png"> <p>没有找到相关数据</p> </div> </div> <div class="mao-screen-area" id="screenArea"> <div id="main" class="mao-main" style="height: 100%;width: 100%;" ></div> <div class="tupu-toolbar"> <ul> <li onclick="editRect(this);"><span class="sel"></span>编辑</li> <li onclick="maoScale(1);"><span class="big"></span>放大</li> <li onclick="maoScale(2);"><span class="small"></span>缩小</li> <li onclick="maoRefresh();"><span class="refresh"></span>刷新</li> <li id="changeScreen" onclick="changeScreen(this);"><span class="screen"></span>全屏</li> <li onclick="saveImg();zhugeTrack('图谱-保存',{'图谱类型':'股权穿透图'});"><span class="save"></span>保存</li> </ul> </div> <div class="water-mark">股权穿透图由企查查基于公开信息利用大数据分析引擎独家生成。</div> <div id="company-detail" class="company-detail tp-detail"> <div class="e_close-bar"> <span class="ea_title">公司信息</span> <span class="ea_close" onclick="popclose(this)">&times;</span> </div> <div class="detail-content-wrap" > <div class="e_pop-detail-top"> <div class="ea_left"> <img class="mao-img" onerror="this.src='/material/theme/chacha/cms/v2/images/default_face.png'" src="/material/theme/chacha/cms/v2/images/default_face.png"> </div> <div class="ea_right"> <div class="ea_row1"><a target="_blank" class="ea_name-com mao-company-name">-</a></div> <div class="ea_row2"><span class="text-gray">法定代表人：</span><a class="mao-oper">-</a></div> <div class="ea_row2"><span class="text-gray">注册资本：</span><span class="text-black mao-ziben">-</span></div> <div class="ea_row2"><span class="text-gray">成立日期：</span><span class="text-black mao-date">-</span></div> </div> </div> <div class="m-t"> <a class="btn mao-tupu-link" target="_blank">查看图谱</a> </div> <div class="m-t mao-content m-b-lg"> <ul class="nav nav-tabs mao-tabs" > <li class="active"><a href="#gudong" aria-controls="gudong" role="tab" data-toggle="tab">股东</a></li> <li><a href="#touzi" aria-controls="touzi" role="tab" data-toggle="tab">对外投资</a></li> <li><a href="#member" aria-controls="member" role="tab" data-toggle="tab">主要成员</a></li> </ul> <div class="tab-content mao-tab-content"> <div role="tabpanel" class="gudong-list tab-pane fade in active" id="gudong"> </div> <div role="tabpanel" class="touzi-list tab-pane fade" id="touzi"> </div> <div role="tabpanel" class="member-list tab-pane fade" id="member"> </div> </div> </div> </div> </div> <div id="person-detail" class="company-detail tp-detail"> <div class="e_close-bar"> <span class="ea_title">人员信息</span> <span class="ea_close" onclick="popclose(this)">&times;</span> </div> <div class="detail-content-wrap" > <div class="e_pop-detail-top"> <div class="ea_left"> <img id="face_oss" onerror="personImgErr()" alt=""> <div class="ea_defaultImg"></div> </div> <div class="ea_right"> <div class="ea_row1"><a class="ea_name">-</a><a class="text-warning allRrelative" target="_blank">他关联<span class="relativeInfoCount">0</span>家企业></a></div> <div class="ea_row2"><span class="text-gray">企业：</span><a id="PerCom" class="text-blue" target="_blank">-</a></div> <div class="ea_row2"><span class="text-gray">职位：</span><span id="PerJob" class="text-black">-</span></div> </div> </div> <div class="m-t"> <a id="ShowPerTupuA" class="btn mao-tupu-link" target="_blank">查看图谱</a> </div> <div id="NameBar">简介</div> </div> </div> </div> <div id="hoverName" class="tooltip-inner" style="position: absolute;z-index: 100;display: none;"></div> <script src="/material/theme/chacha/cms/v2/js/echarts2.js"></script> <script src="/material/theme/chacha/cms/v2/js/slimscroll/jquery.slimscroll.min.js"></script> <script type="text/javascript">
var myChart;
var showKeyNo;
var Text = require('zrender/shape/Text');
var ImageShape = require('zrender/shape/Image');
var Rectangle = require('zrender/shape/Rectangle');
var treeId = 1;
var _currentKeyNo;
var canEditRect = false;
$(document).ready(function () {
    resizeScreen();
    myChart = echarts.init(document.getElementById('main'));
    //new window.zoomutil({dom: $('#mainGuquan')[0], chart:myChart}); // add zoomutil feature
    getData();

});
window.onresize=function(){
    resizeScreen();
}
var rootData;
var gudongData;
var touziData;
function getData(){
    $('#load_data').show();
    var url = INDEX_URL+"cms_guquanmap3";
    $.ajax({
        url:url,
        type: 'GET',
        data:{
            keyNo:getQueryString("keyNo"),
        },
        dataType: 'JSON',
        success: function (data){
            $('#load_data').hide();
            if(data&&data.status === 200){
                $('#no_data').hide();
                rootData = data;
                gudongData = data.gudong;
                touziData = data.touzi;
                transTree(gudongData,1);
                initTree(gudongData);
                transTree(touziData,2);
                initTree(touziData);
                drawGuquan();
                if(window.iframe){
                    setTimeout(function() {
                        if(touziData || gudongData.children.length>4){
                            maoScale(2);
                        }
                        $('.guquan-liframe').hide();
                        $(window.parent.document).find('#guquanIframeTool').show();
                    }, 500);
                }
            }else{
                $('#no_data').show();
                $('#screenArea').hide();
                if(window.iframe){
                    $('.guquan-liframe').hide();
                    $('.guquan-lnodata').show();
                }
            }
        }
    });
}
function changeScreen(dom){
    if(!isFullScreen()){
      $(dom).html('<span class="screened"></span>退出');
      launchFullScreen($('#screenArea')[0]);
    }else{
      $(dom).html('<span class="screen"></span>全屏');
      exitFullScreen();
    }
}
//切换全屏
setFullScreenListener(function(){
  setTimeout(function() {
    myChart.resize();
    initZrender();
  }, 300);
})//
function maoRefresh(){

    refresh();
}
function refresh(){

    var ecConfig = require('echarts/config');
    myChart._messageCenter.dispatch(ecConfig.EVENT.RESTORE, null, null, myChart);
}
function saveImg(){
    if(isFullScreen()){
      $('#changeScreen').html('<span class="screen"></span>全屏');
      exitFullScreen();
      setTimeout(function() {
        jietu();
      }, 1000);
    }else{
      jietu();
    }
    function jietu(){
        var jietuMask=document.createElement("div");
        $(jietuMask).attr('style','position: fixed; background: #fff; z-index: 1000; top: 0px; bottom: 0px; left: 0px; right: 0px;');
        document.body.appendChild(jietuMask);
        var width = 1440;
        var height = 900;
        var minX = 0;
        var maxX = 0;
        var minY = 300;
        var maxY = 0;
        var moveDown = 0;
        var moveRight = 0;
        var shapeList = myChart.getZrender().storage.getShapeList();
        for(var i=0;i<shapeList.length;i++){
            if(shapeList[i].style&&shapeList[i].style.iconType=='rectangle'){
                if(shapeList[i].style.x>maxX){
                    maxX = shapeList[i].style.x;
                }
                if(shapeList[i].style.x<minX){
                    minX = shapeList[i].style.x;
                }
                if(shapeList[i].style.y>maxY){
                    maxY = shapeList[i].style.y;
                }
                if(shapeList[i].style.y<minY){
                    minY = shapeList[i].style.y;
                }
            }
        }
        if((maxX-minX+300)>width){
            width = maxX-minX+300;
            moveRight = -(maxX+minX-myChart.getZrender().getWidth()+146)/2;

        }
        if((maxY-minY+300)>900){
            height = maxY-minY+300;
        }
        moveDown = -(maxY+minY-myChart.getZrender().getHeight())/2-85;

        var layer = myChart.getZrender().painter._layers[1];
        var bS = layer.scale.concat();
        var bP = layer.position.concat();
        layer.scale = [1,1,0,0];
        layer.position = [0,0];
        var bW = myChart.getZrender().getWidth();
        var bH = myChart.getZrender().getHeight();
        $('#main').width(width);
        $('#main').height(height);

        var zdW = myChart.getZrender().getWidth();
        var zdH = myChart.getZrender().getHeight();




        myChart.resize();
        myChart.getZrender().painter.refresh();
        initZrender(true);
        layer.position[0] = moveRight;
        layer.position[1] = moveDown;
        var shape1 = new Rectangle({
            style: {
                x: -1000-moveRight,
                y: -1000-moveDown,
                width: width+1000,
                height: height+1000,
                color:'#fff'
            }
        });
        shape1.zlevel=1;
        shape1.z=-2;
        shape1.ndelete = true;
        myChart.getZrender().addShape(shape1);
        for(var i=0;i<width+100;i+=300){
            for(var j=0;j<height+100;j+=228){
                var shapeSy = new ImageShape({
                    style: {
                        image:'/material/theme/chacha/cms/v2/images/shuiying2.png',
                        x: i-moveRight,
                        y: j-moveDown,
                        width:300,
                        height:228

                    }
                });
                shapeSy.zlevel=1;
                shapeSy.z=-1;
                shapeSy.ndelete = true;
                myChart.getZrender().addShape(shapeSy);
            }
        }
        var shape3 = new Text({
            style: {
                x: width/2-165-moveRight,
                y: height-30-moveDown,
                text: '股权穿透图由企查查基于公开信息利用大数据分析引擎独家生成。',
                strokeColor:'#999',
                color : '#999' ,
                textFont:'normal 12px 微软雅黑',
                lineWidth :0,
            }
        });
        shape3.zlevel=1;
        shape3.z=-1;
        shape3.ndelete = true;
        myChart.getZrender().addShape(shape3);
        setTimeout(function() {
            var canvas = $('#main canvas')[1];
            var isIE11 = (!!window.ActiveXObject || "ActiveXObject" in window);
            if(isIE11){
                downloadimg(canvas);
            }else{
                download(canvas,'jpg');
            }

            $('#main').width('100%');
            $('#main').height(bH);
            myChart.resize();
            layer.scale = bS;
            layer.position = bP;
            myChart.getZrender().render();
            initZrender();
            $(jietuMask).css('display','none');
        }, 300);
    }
}
function maoScale(type){
    var centerX = myChart.getZrender().getWidth()/2;
    var centerY = myChart.getZrender().getHeight()/2;
    var layer = myChart.getZrender().painter._layers[1];
    var x = layer.scale[0]*centerX+layer.position[0];
    var y = layer.scale[1]*centerY+layer.position[1];
    var scale = layer.scale[0];
    if(type==1){
      scale+=0.3;
    }else if(type==2){
      scale-=0.3;
    }
    if(scale>=0.3&&scale<=2){
      layer.scale[0] = scale;
      layer.scale[1] = scale;
      myChart.getZrender().render();
      layer.position[0] = x-layer.scale[0]*centerX
      layer.position[1] = y-layer.scale[1]*centerY
      myChart.getZrender().render();
    }
}
function editRect(dom){
    if(canEditRect){
        $(dom).removeClass('active');
        canEditRect = false;
    }else{
        $(dom).addClass('active');
        canEditRect = true;
    }
    initZrender();
}
function transTree(data,type){
    if(!data) return;
    data.children = data.DetailList;
    data.DetailList = undefined;
    data.treeId = treeId;
    if(type==2){
        data.isTouzi = true;
    }
    var fontSize = 12;
    if(data.ShortStatus=='注销'||data.ShortStatus=='吊销'){
        data.Name = '【'+data.ShortStatus+'】'+data.Name;
    }
    if(data.Name.length>20){
        data.name = data.Name.substr(0,19)+'…';
        data.ltext = true;
    }else{
        data.name = data.Name;
    }
    if(data.Org==2&&data.Name.length>8){
        data.name = data.Name.substr(0,7)+'…';
    }
    data.name = data.name.replace(/(.{10})(?=.)/g, '$1\n');
    if(data.StockRightNum){
        data.subtext = '持股数：'+data.StockRightNum+'';
    }else if(data.ShouldCapi){

        data.subtext = '认缴金额：'+data.ShouldCapi;
    }
    if (data.KeyNo) {
        if(data.Tags){
            for(var i=0; i<data.Tags.length; i++){
                if(data.Tags[i].Type==402){
                    data.tag = data.Tags[i].Name;
                }
            }
        }
    }
    if(data.Tags){
        $.each(data.Tags,function(index,vo){
            if(vo.Type==2){
                data.tag = '上市公司';
                data.list = true;
            }else if(vo.Type==1){
                data.tag = '新三板公司';
                data.list = true;
            }else if(vo.Type==401){
                data.tag = '港股上市';
                data.list = true;
            }
        });
    }
    data.editable = true;
    data.symbol = 'rectangle';
    data.symbolSize= [146, 62];
    if(data.tag){
        data.symbolSize= [146, 82];
    }
    data.labelClick = true;
    data.itemStyle =  {
        normal: {
            color: "#fff",
            borderWidth: "1",
            borderColor: "#ccc",
            label: {
                show: true,
                position: "inside",
                textStyle: {
                    fontFamily: "MicroSoft YaHei",
                    fontSize: fontSize,
                    color:'#333',
                    fontStyle: "normal",
                },
            }
        },
        emphasis: {
            color: "rgba(255,255,255,0)",
            borderWidth: "1",
            borderColor: "rgba(255,255,255,0)",
        }
    };
    if(data.Org==2){
        data.symbol = 'rectangle';
        data.clickable = true;
        data.labelClick = false;
        data.symbolSize= [146, 55];
        data.itemStyle =  {
            normal: {
                color: "#F3F9FE",
                borderWidth: "1",
                borderColor: "#128bed",
                label: {
                    show: !0,
                    position: "inside",
                    textStyle: {
                        color:'#333',
                        fontFamily: "MicroSoft YaHei",
                        fontSize: 14,
                        fontStyle: "normal",
                    },
                }
            },
            emphasis: {
                color: "rgba(255,255,255,0)",
                borderWidth: "1",
                borderColor: "rgba(255,255,255,0)",
            }
        };
    }

    var children = data.children;
    if(children){
        for(var i=0;i<children.length;i++){
            transTree(children[i],type);
            children[i] = addTampArrow(children[i],fontSize);
        }
    }

    if(type==1){
        if(rootData.kzr){
            if(data.KeyNo){
                if(data.KeyNo==rootData.kzr.ControllerData.KeyNo){
                    data.kzr = true;
                }
            }else{
                if(data.Name==rootData.kzr.ControllerData.Name){
                    data.kzr = true;
                }
            }
        }
        if(rootData.syr){
            $.each(rootData.syr.Names,function(index,vo){
                if(data.KeyNo){
                    if(data.KeyNo==vo.KeyNo){
                        data.syr = vo.PercentTotal;
                    }
                }else{
                    if(data.Name==vo.Name){
                        data.syr = vo.PercentTotal;
                    }
                }
            })
        }
    }else if(type==2){
        if(rootData.kg){
            $.each(rootData.kg.Names,function(index,vo){
                if(type==2&&data.KeyNo&&data.KeyNo==vo.KeyNo){
                    data.kg = true;
                }
            })
        }
    }
    treeId++;
}
function addTampArrow(cnode,fontSize){
    var tamp = cnode;
    var Ratio = (!cnode.Percent||cnode.Percent=='0%')?'':cnode.Percent;
    if(Ratio){
        Ratio = (parseFloat(cnode.Percent.substr(0,cnode.Percent.length-1)).toFixed(4))*10000/10000+'%';
        tamp.ratio = Ratio;
    }
    var labelShow = (Ratio != '0%');
    cnode = {
        name:Ratio,
        symbol: "arrowdown",
        symbolSize: [12, 12],
        tooltip: {
            show: !1
        },
        clickable: !1,
        hoverable:false,
        itemStyle: {
            normal: {
                color: "#128bed",
                borderWidth:0,
                label: {
                    show: labelShow,
                    position: "right",
                    textStyle: {
                        fontFamily: "MicroSoft YaHei",
                        fontSize: fontSize,
                        fontStyle: "normal",
                    },
                }
            },
            emphasis: {
                color: "#128bed",
                borderWidth:0,
                label: {
                    show: labelShow,
                    position: "right",
                    textStyle: {
                        fontFamily: "MicroSoft YaHei",
                        fontSize: fontSize,
                        fontStyle: "normal",
                    },
                }
            }
        },
        lineStyle: {
            width: 1,
            color: "#333"
        },
        children:[tamp]
    }
    return cnode;
}
function initTree(data){
    if(!data) return;
    data.name = data.Name;
    data.editable = false;
    data.labelClick = false;
    data.clickable = false;
    data.symbolSize = [data.name.length*16+80, 52];
    data.symbol = 'rectangle';
    data.itemStyle =  {
            normal: {
                color: "#fff",
                borderWidth: "1",
                borderColor: "#128bed",
                label: {
                    show: !0,
                    position: "inside",
                    textStyle: {
                        color:'#000',
                        fontFamily: "MicroSoft YaHei",
                        fontSize: 16,
                        fontStyle: "normal",
                    },
                }
            },
            emphasis: {
                color: "rgba(255,255,255,0)",
                borderWidth: "1",
                borderColor: "#128bed00",
            }
        };
    getNode(gudongData);
    getNode(touziData);
    function getNode(data){
        if(!data) return;
        if(data.children){
            for(var i=0;i<data.children.length;i++){
                getNode(data.children[i]);
            }
        }
        if(data.children&&data.children.length>0&&data.KeyNo&&data.KeyNo!=getQueryString("keyNo")){
            data._children = data.children;
            data.children = null;
            data.extend = 1;
            //data.symbol = 'rectangle';
        }

    }
}
//股权穿透图
function drawGuquan(){
    myChart.clear();
    option = {
        title : {
            text: '',
        },
        series : [

        ]
    };
    var roam = true;
    if(window.iframe){
        roam = 'move';
    }
    if(gudongData){
        option.series.push({
            type: "tree",
            orient: "vertical",
            nodePadding: 25,
            layerPadding: 40,
            symbol:  "circle",
            roam: roam,
            rootLocation: {
                        "x": "50%",
                        "y": "50%"
                    },
            direction:"inverse",
            data: [gudongData]
        });
    }
    if(touziData){
        option.series.push({
            type: "tree",
                orient: "vertical",
                nodePadding: 25,
                layerPadding: 40,
                symbol:  "circle",
                roam: roam,
                rootLocation: {
                            "x": "50%",
                            "y": "50%"
                        },
                //direction:"inverse",
                data: [touziData]
        })
    }
    if(gudongData && !touziData){
       option.series[0].rootLocation.y = '65%';
    }
    myChart.setOption(option);
    initZrender();
    animatieChart(myChart);
    var isDrag;
    var dragStartPos;
    myChart.getZrender().on("mousedown", function (param){
        isDrag = true;
        dragStartPos = [param.event.x,param.event.y];

    });
    myChart.getZrender().on("mouseup", function (param){
        if(dragStartPos[0]==param.event.x&&dragStartPos[1]==param.event.y){
            isDrag = false;
        }
        dragStartPos = [];
    });
    myChart.on('click', function(e){
        if(isDrag) return;
        if((e.data.Org==0||e.data.Org==4||e.data.Org==7||e.data.Org==8||e.data.Org==9)&&e.data.KeyNo&&e.data.KeyNo!=showKeyNo){
            if(e.data.KeyNo[0]=='p'){
                if(window.iframe){
                    window.open('/pl_'+e.data.KeyNo+'.html');
                }else{
                    showKeyNo = e.data.KeyNo;
                    showDetail2(showKeyNo,'company_muhou4','person');
                }
            }else{
                if(window.iframe){
                    window.open('/firm_'+e.data.KeyNo+'.html');
                }else{
                    showKeyNo = e.data.KeyNo;
                    showDetail(showKeyNo,'company_guquan');
                }
            }
        }
        if(e.data.Org==2){
            if(e.data.KeyNo && e.data.KeyNo.length==32){
                if(window.iframe){
                    window.open('/pl_'+e.data.KeyNo+'.html');
                }else{
                    showKeyNo = e.data.KeyNo;
                    showDetail2(showKeyNo,'company_muhou4','person');
                }
            }else{
                window.open('/people?name='+encodeURI(e.data.Name)+'&keyno='+e.data.ParentKeyNo);
            }
        }
    });
    myChart.getZrender().on('click', function(e){
        if(isDrag) return;
        if(e.target&&e.target.clickcom){
            troggleTree(e.target.keyNo,e.target.treeId);
        }
        if(e.target&&e.target.editcom){
            editTree(e.target.keyNo,e.target.treeId);
        }
    });
    var hoverName = ''
    // myChart.on('hover', function(e){
    //     if(e.data.Name&&e.data.Name.length>10&&e.data.Name!=hoverName){
    //         hoverName = e.data.Name;
    //         $('#hoverName').text(e.data.Name);
    //         $('#hoverName').css('left',e.event.screenX-10);
    //         $('#hoverName').css('top',e.event.screenY-50);
    //         $('#hoverName').fadeIn();
    //     }
    // });
    // myChart.on('mouseout', function(e){
    //     hoverName = '';
    //     $('#hoverName').fadeOut();
    // });
    myChart.on('restore', function(param){
        getNode(gudongData);
        getNode(touziData);
        function getNode(data){
            if(!data) return;
            if(data.children){
                for(var i=0;i<data.children.length;i++){
                    getNode(data.children[i]);
                }
            }
            if(data.children&&data.children.length>0&&data.KeyNo&&data.KeyNo!=getQueryString("keyNo")){
                data._children = data.children;
                data.children = null;
                data.extend = 1;
                //data.symbol = 'circleCross';
            }

        }
        myChart.clear();
        myChart.setOption(option);
        initZrender();
        animatieChart(myChart);
    });
}
function initZrender(jietu){
    var shapeList = myChart.getZrender().storage.getShapeList();
    for(var i=0;i<shapeList.length;i++){
        if(shapeList[i].clickcom||shapeList[i].ndelete){
            myChart.getZrender().delShape(shapeList[i].id);
        }
        if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data&&shapeList[i].style.text){
            shapeList[i].style.text = shapeList[i].style.text.replace(/^\s+|\s+$/g,'');
        }
    }
    for(var i=0;i<shapeList.length;i++){
        // if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data.labelClick){
        //     var shape = new Text({
        //       style: {
        //           x: shapeList[i].rotation[1]+25,
        //           y: shapeList[i].rotation[2],
        //           text: shapeList[i]._echartsData._name,
        //           color : '#333' ,
        //           textFont:'normal 13px 微软雅黑',
        //           lineWidth :0,
        //       },
        //       highlightStyle : {
        //           lineWidth :0,
        //           strokeColor:'rgba(0,0,0,0)',
        //         }
        //     });
        //     shape.keyNo = shapeList[i]._echartsData._data.KeyNo;
        //     shape.zlevel = 1;
        //     shape.z = 4;
        //     shape.clickable = true;
        //     myChart.getZrender().addShape(shape);
        // }
        if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data.subtext){
            shapeList[i].style.text = shapeList[i].style.text+'\n';
            var shapeY = shapeList[i].rotation[2]+12;
            if(shapeList[i]._echartsData._data.name.length>10){
                shapeY = shapeList[i].rotation[2]+16;
            }
            if(shapeList[i]._echartsData._data.Org==2){
                shapeY = shapeList[i].rotation[2]+11;
            }
            if(shapeList[i]._echartsData._data.tag){
                if(shapeList[i]._echartsData._data.name.length>10){
                    shapeY = shapeList[i].rotation[2]+4;
                }else{
                    shapeY = shapeList[i].rotation[2]+1;
                }
            }
            var shape = new Text({
              style: {
                  x: shapeList[i].rotation[1],
                  y: shapeY,
                  text: shapeList[i]._echartsData._data.subtext,
                  color : '#666' ,
                  textFont:'normal 11px 微软雅黑',
                  textAlign:'center',
                  lineWidth :0,
              },
              highlightStyle : {
                  lineWidth :0,
                  color : '#666' ,
                  strokeColor:'rgba(255,255,255,0)',
                }
            });
            shape.zlevel = 1;
            shape.z = 5;
            shape.ndelete = true;
            shape.hoverable = false;
            myChart.getZrender().addShape(shape);
        }
        if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data.extend&&!jietu){
            var iconImg = '';
            var isIE11 = (!!window.ActiveXObject || "ActiveXObject" in window);
            if(shapeList[i]._echartsData._data.extend==1){
                if(isIE11){
                    iconImg = '/material/theme/chacha/cms/v2/images/tupu_cross.png';
                }else{
                    iconImg = '/material/theme/chacha/cms/v2/images/tupu_cross.svg';
                }
            }else if(shapeList[i]._echartsData._data.extend==2){
                if(isIE11){
                    iconImg = '/material/theme/chacha/cms/v2/images/tupu_minus.png';
                }else{
                    iconImg = '/material/theme/chacha/cms/v2/images/tupu_minus.svg';
                }

            }
            var shapeY = shapeList[i].rotation[2];
            if(shapeList[i]._echartsData._data.isTouzi){
                shapeY = shapeY + shapeList[i].style.height/2;
            }else{
                 shapeY = shapeY - shapeList[i].style.height/2-18;
            }
            var shape = new ImageShape({
            style: {
                image:iconImg,
                x: shapeList[i].rotation[1]-9,
                y: shapeY,
                width:18,
                height:18

            }
            });
            shape.keyNo = shapeList[i]._echartsData._data.KeyNo;
            shape.treeId = shapeList[i]._echartsData._data.treeId;
            shape.zlevel = 1;
            shape.z = 4;
            shape.ndelete = true;
            shape.clickcom = true;
            shape.hoverable = true;
            shape.clickable = true;
            myChart.getZrender().addShape(shape);
        }
        if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data.editable&&canEditRect&&!jietu){
            var iconImg = '';
            var isIE11 = (!!window.ActiveXObject || "ActiveXObject" in window);
            if(isIE11){
                iconImg = '/material/theme/chacha/cms/v2/images/tupu_delete.png';
            }else{
                iconImg = '/material/theme/chacha/cms/v2/images/tupu_delete.svg';
            }
            var shapeY = shapeList[i].rotation[2];
            if(shapeList[i]._echartsData._data.isTouzi){
                shapeY = shapeY - shapeList[i].style.height/2-9;
            }else{
                 shapeY = shapeY - shapeList[i].style.height/2-18+9;
            }
            var shape = new ImageShape({
            style: {
                image:iconImg,
                x: shapeList[i].rotation[1]-9+72,
                y: shapeY,
                width:18,
                height:18

            }
            });
            shape.zlevel = 1;
            shape.z = 20;
            shape.keyNo = shapeList[i]._echartsData._data.KeyNo;
            shape.treeId = shapeList[i]._echartsData._data.treeId;
            shape.ndelete = true;
            shape.editcom = true;
            shape.hoverable = true;
            shape.clickable = true;
            myChart.getZrender().addShape(shape);
        }
        if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data.kzr&&shapeList[i]._echartsData._data.syr){
            var shape = new ImageShape({
                style: {
                    image:'/material/theme/chacha/cms/v2/images/tupu_kzrsbg.png',
                    x: shapeList[i].rotation[1]-75,
                    y: shapeList[i].rotation[2]-shapeList[i].style.height/2-38,
                    width:150,
                    height:44,
                },
                highlightStyle : {
                  lineWidth :0,
                  strokeColor:'#fff',
                }
            });
            var shapeText = new Text({
                style: {
                    x: shapeList[i].rotation[1],
                    y: shapeList[i].rotation[2]-shapeList[i].style.height/2-18,
                    textFont:'normal 11px 微软雅黑',
                    text:'实际控制人\n'+'最终受益人：'+shapeList[i]._echartsData._data.syr,
                    textAlign:'center',
                    color : '#fff',
                    lineWidth :0,
                },
                highlightStyle : {
                  lineWidth :0,
                  strokeColor:'rgba(255,255,255,0)',
                }
            });
            shape.ndelete = true;
            shape.zlevel = 1;
            shape.z = 8;
            shape.hoverable = false;
            shapeText.zlevel = 1;
            shapeText.z = 10;
            shapeText.ndelete = true;
            shapeText.hoverable = false;
            myChart.getZrender().addShape(shape);
            myChart.getZrender().addShape(shapeText);
        }else if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data.kzr){
            var shape = new ImageShape({
                style: {
                    image:'/material/theme/chacha/cms/v2/images/tupu_kzrbg.png',
                    x: shapeList[i].rotation[1]-75,
                    y: shapeList[i].rotation[2]-shapeList[i].style.height/2-24,
                    width:150,
                    height:30,
                },
                highlightStyle : {
                  lineWidth :0,
                  strokeColor:'rgba(255,255,255,0)',
                }
            });
            var shapeText = new Text({
                style: {
                    x: shapeList[i].rotation[1],
                    y: shapeList[i].rotation[2]-shapeList[i].style.height/2-12,
                    textFont:'normal 11px 微软雅黑',
                    text:'实际控制人',
                    textAlign:'center',
                    color : '#fff',
                    lineWidth :0,
                },
                highlightStyle : {
                  lineWidth :0,
                  color : '#F5A623' ,
                  strokeColor:'rgba(255,255,255,0)',
                }
            });
            shape.ndelete = true;
            shape.zlevel = 1;
            shape.z = 8;
            shape.hoverable = false;
            shapeText.zlevel = 1;
            shapeText.z = 10;
            shapeText.ndelete = true;
            shapeText.hoverable = false;
            myChart.getZrender().addShape(shape);
            myChart.getZrender().addShape(shapeText);
        }else if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data.syr){
            var shape = new ImageShape({
                style: {
                    image:'/material/theme/chacha/cms/v2/images/tupu_syrbg.png',
                    x: shapeList[i].rotation[1]-75,
                    y: shapeList[i].rotation[2]-shapeList[i].style.height/2-24,
                    width:150,
                    height:30,
                },
                highlightStyle : {
                  lineWidth :0,
                  strokeColor:'rgba(255,255,255,0)',
                }
            });
            var shapeText = new Text({
                style: {
                    x: shapeList[i].rotation[1],
                    y: shapeList[i].rotation[2]-shapeList[i].style.height/2-12,
                    textFont:'normal 11px 微软雅黑',
                    text:'最终受益人：'+shapeList[i]._echartsData._data.syr,
                    textAlign:'center',
                    color : '#fff',
                    lineWidth :0,
                },
                highlightStyle : {
                  lineWidth :0,
                  color : '#F5A623' ,
                  strokeColor:'rgba(255,255,255,0)',
                }
            });
            shape.ndelete = true;
            shape.zlevel = 1;
            shape.z = 8;
            shape.hoverable = false;
            shapeText.zlevel = 1;
            shapeText.z = 10;
            shapeText.ndelete = true;
            shapeText.hoverable = false;
            myChart.getZrender().addShape(shape);
            myChart.getZrender().addShape(shapeText);
        }
        if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data.kg){
            var shapeY = shapeList[i].rotation[2]-shapeList[i].style.height/2-21.5;
            if(shapeList[i]._echartsData._data.tag){
                shapeY += 9;
            }
            var shapeX = shapeList[i].rotation[1] + 28
            if(shapeList[i]._echartsData._data.ratio){
                shapeX += shapeList[i]._echartsData._data.ratio.length*10
                if(shapeList[i]._echartsData._data.ratio.indexOf('.') != -1){
                    shapeX -= 10;
                }
            }
            var shapeText = new Text({
                style: {
                    x: shapeX,
                    y: shapeY,
                    textFont:'normal 11px 微软雅黑',
                    text:'(控股)',
                    textAlign:'center',
                    color : '#FD485E',
                    lineWidth :0,
                },
                highlightStyle : {
                  lineWidth :0,
                  color : '#FD485E' ,
                  strokeColor:'rgba(255,255,255,0)',
                }
            });
            shapeText.zlevel = 1;
            shapeText.z = 10;
            shapeText.ndelete = true;
            shapeText.hoverable = false;
            myChart.getZrender().addShape(shapeText);
        }
        if(shapeList[i]._echartsData&&shapeList[i]._echartsData._data.tag){
            shapeList[i].style.text = shapeList[i].style.text+'\n\n';
            var shapeColor = '#FFECCE';
            var shapeTextColor = '#F5A623';
            if(shapeList[i]._echartsData._data.list){
                shapeColor = '#DDF0FF';
                shapeTextColor = '#128bed';
            }
            var shape = new Rectangle({
                style: {
                    x: shapeList[i].rotation[1]-72.5,
                    y: shapeList[i].rotation[2]+shapeList[i].style.height/2-22.5,
                    width:145,
                    height:22,
                    color:shapeColor,
                },
                highlightStyle : {
                  lineWidth :0,
                  color:'rgba(255,255,255,0)',
                  strokeColor:'#fff',
                }
            });
            var shapeText = new Text({
                style: {
                    x: shapeList[i].rotation[1]-2,
                    y: shapeList[i].rotation[2]+shapeList[i].style.height/2-12,
                    textFont:'normal 12px 微软雅黑',
                    text: shapeList[i]._echartsData._data.tag,
                    textAlign:'center',
                    color : shapeTextColor,
                    fontSize:14,
                    lineWidth :0,
                },
                highlightStyle : {
                  lineWidth :0,
                  color : shapeTextColor ,
                  strokeColor:'rgba(255,255,255,0)',
                }
            });
            shape.zlevel = 1;
            shape.z = 4;
            shape.ndelete = true;
            shape.hoverable = false;
            shapeText.zlevel = 1;
            shapeText.z = 5;
            shapeText.ndelete = true;
            shapeText.hoverable = false;
            myChart.getZrender().addShape(shape);
            myChart.getZrender().addShape(shapeText);
        }
    }
    for(var i=0;i<myChart.getZrender().getWidth()+100;i+=300){
        for(var j=0;j<myChart.getZrender().getHeight()+100;j+=228){
            var shapeSy = new ImageShape({
                style: {
                    image:'/material/theme/chacha/cms/v2/images/shuiying2.png',
                    x: i,
                    y: j,
                    width:300,
                    height:228
                }
            });
            shapeSy.hoverable = false;
            shapeSy.ndelete = true;
            myChart.getZrender().addShape(shapeSy);
        }
    }
}
function editTree(KeyNo,tid){
    getNode(gudongData);
    getNode(touziData);
    var dnode;
    var dIndex;
    function getNode(data){
        if(!data) return;
        if(data.children){
            for(var i=0;i<data.children.length;i++){
                var cnode = data.children[i].children[0];
                if(cnode.treeId==tid){
                    dIndex = i;
                    dnode = data;
                    return;
                }
                getNode(cnode);
            }
        }
    }
    dnode.children.splice(dIndex, 1);
    if(dnode.children.length==0){
        dnode.children = [];
        dnode.extend = undefined;
    }
    myChart.clear();
    myChart.setOption(option);
    initZrender();
}
function troggleTree(KeyNo,tid){
    // if(KeyNo==getQueryString("keyNo")){
    //     return;
    // }
    getNode(gudongData);
    getNode(touziData);
    function getNode(data){
        if(!data) return;
        if(data.KeyNo&&data.KeyNo==KeyNo && data.treeId==tid){
            if(data.children){
                data._children = data.children;
                data.children = null;
                data.extend = 1;
                //data.symbol = 'circleCross';
            }else if(data._children){
                data.children = data._children;
                data._children = null;
                data.extend = 2;
                ajaxtouzidata(data,KeyNo);
                ajaxgudongdata(data, KeyNo);
                //data.symbol = 'circleMinus';
            }
            return;
        }
        if(data.children){
            for(var i=0;i<data.children.length;i++){
                getNode(data.children[i]);
            }
        }
    }
    myChart.clear();
    myChart.setOption(option);
    initZrender();
}
function ajaxtouzidata(node,KeyNo) {

    if(!node.isTouzi || node.ajaxtouzi){
        return;
    }
    $.ajax({
        url:INDEX_URL+'cms_guquanmapinvestment',
        data:{
            keyNo:KeyNo
        },
        dataType:'JSON',
        success:function(data){
            if(data.touzi&&data.touzi.DetailList.length>0){
                addTreeChild(node,data);
            }
        },
    })
}
function addTreeChild(node,data){
    if(!node.children){
        return;
    }
    $.each(node.children,function(index,vo){
        var cnode = vo.children[0];
        $.each(data.touzi.DetailList,function(i,ndata){
            if(ndata.KeyNo==cnode.KeyNo){
                if(ndata.DetailList.length>0){
                    cnode.DetailList = ndata.DetailList;
                    transTree(cnode,2);
                    cnode._children = cnode.children;
                    cnode.children = null;
                    cnode.extend = 1;
                }

            }
        })
    })
    node.ajaxtouzi = true;
    myChart.clear();
    myChart.setOption(option);
    initZrender();
}
//动态加载股东节点
function ajaxgudongdata(node, KeyNo) {
    if (node.isTouzi || node.ajaxgudong) {
        return;
    }
    if (KeyNo == null) {
        return;
    }
    $.ajax({
        url:INDEX_URL+'cms_guquanmapownership',
        data: {
            keyNo: KeyNo,
            level: 2,
        },
        dataType: 'JSON',
        success: function (data) {
            if(data.gudong&&data.gudong.DetailList.length>0){
                addGudongTreeChild(node, data);
            }
        }
    })
}
function addGudongTreeChild(node, data) {
    $.each(node.children, function (index, vo) {
        var cnode = vo.children[0];
        $.each(data.gudong.DetailList, function (i, ndata) {
            if (ndata.KeyNo == cnode.KeyNo && ndata.Name.replace(/[^\X]/g,'') == cnode.Name.replace(/[^\X]/g,'')) {
                if (ndata.DetailList.length > 0) {
                    cnode.DetailList = ndata.DetailList;
                    transTree(cnode, 1);
                    cnode._children = cnode.children;
                    cnode.children = null;
                    cnode.extend = 1;
                }
            }
        })
    })
    node.ajaxgudong = true;
    myChart.clear();
    myChart.setOption(option);
    initZrender(false,'');
}
function resizeScreen(){
  if(document.body.clientHeight>700){
      $('#screenArea').height(document.body.clientHeight-66);
  }else if(window.iframe){
      $('#screenArea').width(886);
      $('#screenArea').height(418);
      $('#main').width(886);
      $('#main').height(418);
  }else{
      $('#screenArea').height(640);
  }
}
function popclose(dom){
    $(dom).parent().parent().fadeOut();
    if(showKeyNo){
        showKeyNo = '';
    }
}
function personImgErr() {
    var name = $(".ea_name").text();
    $('#face_oss').hide();
    $('.ea_defaultImg').show();
    $('.ea_defaultImg').text(name[0]);
}
if(window.iframe){
    $('.navi-header').hide();
    $('.mao-head').hide();
    $('.tupu-toolbar').hide();
    timeoutRoam();
}
function timeoutRoam(){
    var roamTimer;
    var roamed =false;
    $('#main').on('mouseenter',function(e){
        if(!roamed){
            roamTimer = setTimeout(function() {
                $.each(option.series,function(i,v){
                    v.roam = true;
                })
                myChart.clear();
                myChart.setOption(option);
                initZrender();
                roamed = true;
            }, 800);
        }
    })
    $('#main').on('mouseout',function(e){
        if(roamTimer){
            clearTimeout(roamTimer);
            roamTimer = null;
        }
        if(roamed){
            $.each(option.series,function(i,v){
                v.roam = 'move';
            })
            myChart.clear();
            myChart.setOption(option);
            initZrender();
            roamed = false;
        }
    })
}
function downloadimg(canvas) {
    var qual = 1;
    if(canvas.width>3000){
        qual = 0.5;
    }else if(canvas.width>5000){
        qual = 0.4;
    }
    //设置保存图片的类型
    var imgdata = canvas.toDataURL('image/jpeg',qual);
    var filename = '的股权穿透图_'+new Date().toLocaleDateString() + '.jpeg';
    post(INDEX_URL+'cms_downloadimg?filename='+filename, {img:imgdata});
}
function post(URL, PARAMS) {
    var temp = document.createElement("form");
    temp.action = URL;
    temp.enctype = "multipart/form-data";
    temp.method = "post";
    temp.style.display = "none";
    for (var x in PARAMS) {
        var opt = document.createElement("textarea");
        opt.name = x;
        opt.value = PARAMS[x];
        temp.appendChild(opt);
    }
    document.body.appendChild(temp);
    temp.submit();
    return temp;
}
</script> <style>
    /*详情弹窗*/
    .company-detail{padding: 0px;top:75px;}
    .detail-content-wrap{padding: 10px 20px;}
    .detail-bottom{height: 350px;overflow-y: auto;padding-right: 3px;}
    .detail-title-wrap{margin-bottom:10px;}
    .detail-title{color:#000000;font-size: 16px;font-weight:600;}
    .detail-count{color:#128BED;font-size: 16px;padding-left:6px;}
    .detail-a,.detail-a:hover{color:#128BED;font-size: 14px;}
    .detail-content{border:1px solid #E4EEF6;padding: 12px;margin-bottom: 20px;}
    #NameBar{position: absolute;background: white;width:252px;height:30px;bottom:362px;/*bottom:346px;*/line-height: 30px;z-index: 2;
        font-size:16px;font-weight: 600;}
    #NameBar .detail-count{font-weight: normal;}
    #NameBar .detail-a{font-weight: normal;margin-right:10px;}
    /**/
    #ScrollContent .detail-title-wrap a.pull-right{margin-right: 10px;}
    .marginNone{margin-bottom: 0px !important;}
</style> <script type="text/template" id="PerDeailTpl">
    <div id="ScrollContent" class="m-t mao-content m-b-lg detail-bottom">
            <div class="detail-title-wrap" style="margin-top: 0px;">
                <span class="detail-title">简介</span>
            </div>
            <div class="detail-content">
                <div class="e_contentMore">
                    <div class="ea_content"><span id="des">暂无</span></div>
                    <a class="ea_bt">...展开</a>
                </div>
            </div>
            <div id="glgs" class="detail-title-wrap">
                <span class="detail-title">关联公司</span><span class="relativeInfoCount detail-count">0</span><a target="_blank" class="detail-a pull-right allRrelative">查看全部></a>
            </div>
            <table class="ntable">
                <thead><tr><th  class="tb" style="text-align: left;">名称</th><th  class="tb" style="width: 96px;">法定代表人</th></tr></thead>
                <tbody id="relativeInfoData">
                </tbody>
            </table>
            <div id="BossInfo" style="display: none;">
                <div class="detail-title-wrap">
                    <span class="detail-title">基本信息</span>
                </div>
                <table class="ntable">
                    <tbody>
                    <tr><td class="tb" style="width: 85px;">毕业院校</td><td id="biye">-</td></tr>
                    <tr><td class="tb">所学专业</td><td id="zhuanye">-</td></tr>
                    <tr><td class="tb">最高学历</td><td id="xueli">-</td></tr>
                    <tr><td class="tb">爱好</td><td id="hobby">-</td></tr>
                    <tr><td class="tb">工作单位</td><td id="companyname">-</td></tr>
                    <tr><td class="tb">职务</td><td id="job">-</td></tr>
                    </tbody>
                </table>
                <div id="edu-wrap">
                    <div class="detail-title-wrap">
                        <span class="detail-title">教育经历</span>
                    </div>
                    <div id="edu"></div>
                </div>
                <div id="everjob-wrap">
                    <div class="detail-title-wrap">
                        <span class="detail-title">工作经历</span>
                    </div>
                    <div id="everjob">
                    </div>
                </div>
                <div id="milestone-wrap">
                    <div class="detail-title-wrap">
                        <span class="detail-title">重要事件</span>
                    </div>
                    <table class="ntable">
                        <tbody id="milestone">
                        <tr><td>暂无</td></tr>
                        </tbody>
                    </table>
                </div>
                <div id="sayings-wrap">
                    <div class="detail-title-wrap">
                        <span class="detail-title">相关新闻</span>
                    </div>
                    <table class="ntable">
                        <tbody id="sayings">
                        <tr><td>暂无</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
    </div>
</script> <script>
    /*详情滚动时显示标题*/
    function scrollTitleInit() {
        // 滚动显示标题
        var showIndex = 0;
        var pos = [];
        var showWraps = [];
        var wraps = document.getElementsByClassName("detail-title-wrap");
        for(var i = 0; i < wraps.length; i++){
            var w = wraps[i];
            var obj = {name:'',y:0}
            obj.name = $(w).find(".detail-title").text();
            obj.y = w.offsetTop;
            if(obj.y || i == 0){
                pos.push(obj);
                showWraps.push(w);
            }
        }
        $("#NameBar").html($(showWraps[0]).html());
        $('#ScrollContent').scroll(function () {
            var top = $(this).scrollTop();
            top += 250;
            showIndex = 0;
            for(var i = 0; i < pos.length; i++){
                if((i+1) < pos.length && top < pos[i+1].y){
                    showIndex = i;
                    break;
                }
                if((i+1) == pos.length){
                    showIndex = i;
                }
            }
            $("#NameBar").html($(showWraps[showIndex]).html());
            $("#NameBar").show();
        });
    }
    /**/
    function showDetail2(keyNo,tupuUrl,type){
        $(".company-detail").hide();
        if(type && type == 'person'){
            var url = INDEX_URL+"boss_getDetail";
            $.ajax({
                url: url,
                type: 'GET',
                data: {"keyNo": keyNo},
                dataType: 'JSON',
                success: function (data) {
                    if(!data.name) return;
                    $("#ScrollContent").remove();
                    // $("#ShowPerTupu").after($("#PerDeailTpl").html());
                    $("#NameBar").after($("#PerDeailTpl").html());
                    /*人物搜索里的查看图谱*/
                    if(_currentKeyNo == keyNo || !data.boss_id){
                        $("#ShowPerTupu").attr('canshow','0');
                        $("#ShowPerTupu").hide();
                    } else {
                        $("#ShowPerTupu").attr('keyno',keyNo);
                        $("#ShowPerTupu").attr('canshow','1');
                        $("#ShowPerTupu").show();
                    }
                    /*muhou3 muhou4里的查看图谱*/
                    if(_currentKeyNo == keyNo){
                        $("#ShowPerTupuA").parent().hide();
                    } else {
                        $("#ShowPerTupuA").parent().show();
                        $("#ShowPerTupuA").attr("href","/company_muhou4?keyNo="+keyNo+"&name="+encodeURIComponent(data.name));
                    }
                    $("#BossInfo").hide();
                    $('.allRrelative').attr('href','/pl_'+keyNo);
                    $('.ea_name').text(data.name ? data.name : '-');
                    $('.ea_name').attr('href','/pl_'+keyNo);
                    $('.ea_defaultImg').text();
                    $('.ea_defaultImg').hide();
                    $('#face_oss').show();
                    if(data.boss_id){
                        $('#face_oss').attr('src',data.face_oss);
                    } else {
                        $('#face_oss').attr('src','https://co-image.qichacha.com/PersonImage/' + keyNo + '.jpg' );
                    }
                    $('#PerCom').text(data.companyname ? data.companyname : '-');
                    $('#PerJob').text(data.job ? data.job : '-');
                    if(data.companykey){
                        $('#PerCom').attr('href','/firm_'+data.companykey);
                    } else {
                        $('#PerCom').attr('href','');
                    }
                    $("#des").parent().parent().removeAttr('style');
                    $("#des").text(data.des ? data.des : '暂无');
                    /*简介没有时隐藏*/
                    if(!data.des){
                        var desWrap = $("#des").parent().parent().parent();
                        desWrap.siblings('.detail-title-wrap').eq(0).remove();
                        desWrap.remove();
                    }
                    $(".relativeInfoCount").text(data.relativeInfoCount ? data.relativeInfoCount : '0');
                    $("#relativeInfoData").html('');
                    if(data.relativeInfoData && data.relativeInfoData.length){
                        var html = '';
                        data.relativeInfoData.forEach(function (obj,index) {
                            obj.Name = obj.Name ? obj.Name : '-';
                            obj.OperName = obj.OperName ? obj.OperName : '-';
                            if(index < 10){
                                html += '<tr><td>' +
                                    '<a class="c_a" target="_blank" href="/firm_'+obj.KeyNo+'"><span>'+ obj.Name +'</span></a></td>'  +
                                    '<td style="text-align: center;">'+ obj.OperName +'</td></tr>'
                            }
                        })
                        $("#relativeInfoData").html(html);
                    }
                    if(data.boss_id){ // 热门人物
                        $("#BossInfo").show();
                        $('#biye').text(data.biye ? data.biye : '-');
                        $('#zhuanye').text(data.zhuanye ? data.zhuanye : '-');
                        $('#xueli').text(data.xueli ? data.xueli : '-');
                        $('#hobby').text(data.hobby ? data.hobby : '-');
                        $('#companyname').text(data.companyname ? data.companyname : '-');
                        $('#job').text(data.job ? data.job : '-');
                        /*教育经历*/
                        $('#edu').html('');
                        var edus = '';
                        if(data.edu){
                            edus = JSON.parse(data.edu);
                        }
                        if(data.edu && edus && edus.length){
                            var html = '';
                            edus.forEach(function (obj) {
                                if(!obj.TimeQuantum){obj.TimeQuantum = '-'}
                                if(!obj.Diplomas){obj.Diplomas = '-'}
                                if(!obj.University){obj.University = '-'}
                                if(!obj.Major){obj.Major = '-'}
                                html += '<table class="ntable"><tbody>' +
                                    '<tr><td class="tb" style="width: 85px;">教育时间</td><td >'+ obj.TimeQuantum +'</td></tr>'+
                                    '<tr><td class="tb">学历</td><td>'+ obj.Diplomas +'</td></tr>'+
                                    '<tr><td class="tb">毕业院校</td><td>'+ obj.University +'</td></tr>'+
                                    '<tr><td class="tb">所学专业</td><td>'+ obj.Major +'</td></tr>'+
                                    '</tbody></table>';
                            })
                            $('#edu').html(html);
                            $('#edu-wrap').show();
                        } else {
                            $('#edu-wrap').hide();
                        }
                        /*工作经历*/
                        $('#everjob').html('');
                        var jobs = '';
                        if(data.everjob){
                            jobs = JSON.parse(data.everjob);
                        }
                        if(data.everjob && jobs && jobs.length){
                            var html = '';
                            jobs.forEach(function (obj) {
                                if(!obj.TimeQuantum){obj.TimeQuantum = '-'}
                                if(!obj.Job){obj.Job = '-'}
                                if(!obj.CompanyName){obj.CompanyName = '-'}
                                if(!obj.Abstract){obj.Abstract = '-'}
                                html += '<table class="ntable"><tbody>' +
                                    '<tr><td class="tb" style="width: 85px;">工作时间</td><td >'+ obj.TimeQuantum +'</td></tr>'+
                                    '<tr><td class="tb">职位</td><td>'+ obj.Job +'</td></tr>'+
                                    '<tr><td class="tb">工作单位</td><td>'+ obj.CompanyName +'</td></tr>'+
                                    '<tr><td class="tb">描述</td><td>'+
                                    '<div class="e_contentMore">'+
                                    '<div class="ea_content">'+ obj.Abstract +'</div>'+
                                    '<a class="ea_bt">...展开</a>'+
                                    '</div>'+
                                    '</td></tr>'+
                                    '</tbody></table>';
                            })
                            $('#everjob').html(html);
                            $('#everjob-wrap').show();
                        } else {
                            $('#everjob-wrap').hide();
                        }
                        /*重要事件*/
                        $('#milestone').html('');
                        var milestones = '';
                        if(data.milestone){
                            milestones = JSON.parse(data.milestone);
                        }
                        if(data.milestone && milestones && milestones.length){
                            var html = '';
                            milestones.forEach(function (obj) {
                                if(!obj.Milestone){obj.Milestone = '-'}
                                html += '<tr><td><div class="e_contentMore">'+
                                    '<div class="ea_content">'+ obj.Milestone +'</div>'+
                                    '<a class="ea_bt">...展开</a>'+
                                    '</div></td></tr>';
                            })
                            $('#milestone').html(html);
                            $('#milestone-wrap').show();
                        }else {
                            $('#milestone-wrap').hide();
                        }
                        /*相关新闻*/
                        $('#sayings').html('');
                        var sayings = '';
                        if(data.sayings){
                            sayings = JSON.parse(data.sayings);
                        }
                        if(data.sayings && sayings && sayings.length){
                            var html = '';
                            sayings.forEach(function (obj) {
                                if(!obj.TimeQuantum){obj.TimeQuantum = '-'}
                                if(!obj.Job){obj.Job = '-'}
                                if(!obj.CompanyName){obj.CompanyName = '-'}
                                if(!obj.Abstract){obj.Abstract = '-'}
                                obj.Link = obj.Link.replace('http://','');
                                obj.Link = obj.Link.replace('https://','');
                                html += '<tr><td><a target="_blank" href="http://'+ obj.Link +'">'+ obj.Title +'</a></td></tr>';
                            })
                            $('#sayings').html(html);
                            $('#sayings-wrap').show();
                        }else {
                            $('#sayings-wrap').hide();
                        }
                    }
                    $("#person-detail").fadeIn();
                    /*e_contentMore元素初始化*/
                    $(".e_contentMore").each(function () {
                        var wrap = $(this);
                        var content = wrap.find(".ea_content");
                        var bt = wrap.find(".ea_bt");
                        var wrapHeight = wrap.height();
                        var contentHeight = content.height();
                        if(contentHeight > wrapHeight){
                            bt.show();
                        } else {
                            bt.hide();
                        }
                        bt.click(function () {
                            if(bt.text() == "收起"){
                                wrap.css({maxHeight:wrapHeight});
                                bt.text("...展开");
                            } else {
                                wrap.css({maxHeight:(contentHeight + 20),height:(contentHeight + 20)});
                                bt.text("收起");
                            }
                            scrollTitleInit();
                        });
                    })
                    /*样式处理,bug #2191-1*/
                    if($("#BossInfo").is(':hidden')){
                        $("#glgs").siblings('.ntable').addClass('marginNone');
                    } else {
                        $("#glgs").siblings('.ntable').removeClass('marginNone');
                    }
                    /*$('#ScrollContent').slimScroll({
                        wheelStep: 1
                    });*/
                    scrollTitleInit();
                },
                error:function(data){
                    console.log(data);
                }
            });
        } else {
            var url = INDEX_URL+"more_findRelationsDetail";
            $.ajax({
                url: url,
                type: 'GET',
                data: {"keyNo": keyNo},
                dataType: 'JSON',
                success: function (data) {
                    if(data.Status!=200){
                        return;
                    }
                    var companyDetail = $('#company-detail');
                    companyDetail.find('.mao-img').attr("src",data.Result.ImageUrl);
                    companyDetail.find('.mao-company-name').text(data.Result.Name);
                    companyDetail.find('.mao-company-status').text(data.Result.ShortStatus||'-');
                    if(data.Result.Oper&&data.Result.Oper.Name){
                        if(data.Result.Oper.KeyNo){
                            if(data.Result.Oper.KeyNo[0]=='p'){
                                companyDetail.find('.mao-oper').html('<a target="_blank" href="/pl_'+data.Result.Oper.KeyNo+'.html">'+data.Result.Oper.Name+'</a>');
                            }else{
                                companyDetail.find('.mao-oper').html('<a target="_blank" href="/firm_'+data.Result.Oper.KeyNo+'.shtml">'+data.Result.Oper.Name+'</a>');
                            }
                        }else{
                            companyDetail.find('.mao-oper').html('<a target="_blank" href="/people?name='+encodeURI(data.Result.Oper.Name)+'&keyno='+keyNo+'">'+data.Result.Oper.Name+'</a>');
                        }
                        if(data.Result.Oper.OperType==1){
                            companyDetail.find('.mao-oper').prev().text('法定代表人：');
                        }else if(data.Result.Oper.OperType==2){
                            companyDetail.find('.mao-oper').prev().text('执行事务合伙人：');
                        }else if(data.Result.Oper.OperType==3){
                            companyDetail.find('.mao-oper').prev().text('负责人：');
                        }else if(data.Result.Oper.OperType==4){
                            companyDetail.find('.mao-oper').prev().text('经营者：');
                        }else if(data.Result.Oper.OperType==5){
                            companyDetail.find('.mao-oper').prev().text('投资人：');
                        }else if(data.Result.Oper.OperType==6){
                            companyDetail.find('.mao-oper').prev().text('董事长：');
                        }else if(data.Result.Oper.OperType==7){
                            companyDetail.find('.mao-oper').prev().text('理事长：');
                        }
                    }else{
                        companyDetail.find('.mao-oper').text('-');
                    }
                    companyDetail.find('.mao-ziben').text(data.Result.RegistCapi || '-');
                    companyDetail.find('.mao-date').text((data.Result.StartDate || ''));
                    companyDetail.find('.mao-company-name').attr("href","firm_"+keyNo+".shtml");
                    if(!tupuUrl){
                        tupuUrl = 'company_relation';
                    }
                    companyDetail.find('.mao-tupu-link').attr("href",tupuUrl+"?keyNo="+keyNo+"&name="+encodeURIComponent(data.Result.Name));
                    //companyDetail.find('.mao-tupu-link').attr("onclick","zhugeTrack(\'图谱页面-侧边栏企业信息-查看图谱\')");
                    companyDetail.find('.close').click(function(){
                        companyDetail.fadeOut();
                    });
                    if(_currentKeyNo == keyNo){
                        $(".mao-tupu-link").parent().hide();
                    } else {
                        $(".mao-tupu-link").parent().show();
                    }
                    var noData = '<div class="mao-noresult"> <p ><img src="/material/theme/chacha/cms/v2/images/nodata.png"></p>暂无信息</div>';
                    //股东
                    if(data.Result.Partners && data.Result.Partners.length>0){
                        var html = '<table class="ntable">';
                        html += "<thead><tr><th style='text-align: left'>名称</th><th>类型</th></tr></thead>";
                        for(var i=0; i<data.Result.Partners.length; i++){
                            html += "<tr>";
                            if(data.Result.Partners[i].KeyNo){
                                if(data.Result.Partners[i].KeyNo[0]=='p'){
                                    html += '<td><a onclick="" target="_blank" href="/pl_'+data.Result.Partners[i].KeyNo+'.html">'+data.Result.Partners[i].StockName+'</a></td>';
                                }else{
                                    html += '<td><a onclick="" target="_blank" href="/firm_'+data.Result.Partners[i].KeyNo+'.shtml">'+data.Result.Partners[i].StockName+'</a></td>';
                                }
                            }else{
                                if(data.Result.Partners[i].StockName.length>3){
                                    html += "<td>"+data.Result.Partners[i].StockName+"</td>";
                                }else{
                                    html += '<td><a onclick="" target="_blank" href="/people?name='+encodeURI(data.Result.Partners[i].StockName)+'&keyno='+keyNo+'">'+data.Result.Partners[i].StockName+'</a></td>';
                                }
                            }
                            html += "<td>"+(data.Result.Partners[i].StockType || "-")+"</td>";
                            html += "</tr>";
                        }
                        html+='</table>'
                        companyDetail.find('.gudong-list').html(html);
                    }else {
                        companyDetail.find('.gudong-list').html(noData);
                    }
                    //投资
                    if(data.Result.touziList && data.Result.touziList.length>0){
                        var html = '<table class="ntable">';
                        html += "<thead><tr><th  style='text-align: left'>名称</th></tr></thead>";
                        for(var i=0; i<data.Result.touziList.length; i++){
                            html += "<tr>";
                            html += "<td><a onclick='' href='/firm_"+data.Result.touziList[i].KeyNo+".shtml' target='_blank'>"+data.Result.touziList[i].Name+"</a></td>";
                            html += "</tr>";
                        }
                        html+='</table>';
                        companyDetail.find('.touzi-list').html(html);
                    }else {
                        companyDetail.find('.touzi-list').html(noData);
                    }
                    //成员
                    if(data.Result.Employees && data.Result.Employees.length>0){
                        var html = '<table class="ntable">';
                        html += "<thead><tr><th  style='text-align: left'>名称</th><th>类型</th></tr></thead>";
                        for(var i=0; i<data.Result.Employees.length; i++){
                            html += "<tr>";
                            if(data.Result.Employees[i].KeyNo && data.Result.Employees[i].KeyNo[0]=='p'){
                                html += '<td><a onclick="" target="_blank" href="/pl_'+data.Result.Employees[i].KeyNo+'.html">'+data.Result.Employees[i].Name+'</a></td>';
                            }else{
                                html += '<td><a onclick="" target="_blank" href="/people?name='+encodeURI(data.Result.Employees[i].Name)+'&keyno='+keyNo+'">'+data.Result.Employees[i].Name+'</a></td>';
                            }
                            html += "<td>"+(data.Result.Employees[i].Job||"-")+"</td>";
                            html += "</tr>";
                        }
                        html+='</table>';
                        companyDetail.find('.member-list').html(html);
                    }else {
                        companyDetail.find('.member-list').html(noData);
                    }
                    $("#company-detail").fadeIn();
                    companyDetail.find('.mao-tab-content').slimScroll({
                        wheelStep: 1
                    });
                },
                error:function(data){
                    console.log(data);
                }
            });
        }
    }
    /*ie兼容*/
    var isIE = (!!window.ActiveXObject || "ActiveXObject" in window);
    if(isIE){
        $("#NameBar").css({'width':'270px'});
    }
</script> <style type="text/css">
    #vipModal .modal-dialog{
        width: 780px;
    }
    #vipModal .modal-content{
        padding-bottom: 25px;
        border-radius: 0px;
        text-align: center;
    }
    #vipModal .close{
        color: #FFF;
        font-size: 40px;
        opacity: 0.8;
        font-weight: normal;
        position: absolute;
        right: 10px;
    }
    .step2{display: none;}
</style> <link type="text/css" href="/material/theme/chacha/cms/v2/css/vip-modal.css?version=1562322400" rel="stylesheet"/> <div class="modal fade" id="vipModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> <div class="modal-dialog nmodal"> <div class="modal-content"> <div class="vip-top"> <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">x</span></button> <div class="vip-title"> <h2 class="title">立即成为VIP</h2> <h3 class="sub-title"><span>更多特权 超值服务</span><a href="/vip">全部特权></a></h3> </div> <div class="vip-buy-panel"> <div class="vip-year-list clearfix"> <div data-id="17" data-year="3" data-price="720" class="vip-kuang vip-year active"> <div class="price"> <span>720元</span> <span class="vip-pay">/</span>
                                3年
                            </div> <div class="origin-price">原价：2160元</div> <div class="vip-rec"></div> </div> <div data-id="7" data-year="2" data-price="540" class="vip-kuang vip-year"> <div class="price"> <span>540元</span> <span class="vip-pay">/</span>
                                2年
                            </div> <div class="origin-price">原价：1440元</div> </div> <div data-id="6" data-year="1" data-price="360" class="vip-kuang vip-year"> <div class="price"> <span>360元</span> <span class="vip-pay">/</span>
                                1年
                            </div> <div class="origin-price">原价：720元</div> </div> </div> <div class="step1 m-t-md"> <a onclick="modalJumpVip()" class="vip-btn">立即开通</a> <div class="vip-publicity">支付后可开发票</div> </div> <form id="pay-form" class="vip-pay-info step2" target="aliPayFrame" role="form" method="post" action="/order_pay"> <div class="clearfix"> <span class="pre">购买账号：</span><span class="after"></span> </div> <div class="clearfix coupon-drop" > <span class="pre">优惠券：</span><span  data-toggle="dropdown" class="after drop"><span id="couponText">暂无优惠券</span><span class="caret"></span></span> <ul class="dropdown-menu" id="couponList"> <li> <span class="coupon-type">暂无优惠券</span> </li> </ul> </div> <div class="clearfix  m-b-xs"> <span class="pre">实付金额：</span><span class="after vip-pay" id="payYear">¥720.00</span> </div> <input type="hidden" name="order_type" value="2"/> <input type="hidden" name="goods_id" value="17"/> <input type="hidden" name="pay_type" value="2"/> <input type="hidden" name="coupon_code" value=""/> <input type="submit" class="btn btn-primary packages-btn" value="立即支付" style="display: none"/> </form> </div> </div> <div class="vip-pay-container clearfix"> <div class="step1"> <img class="demo-img" src="/material/theme/chacha/cms/v2/images/vip/fxsm.png"/> <a class="vip-demo-link" href=""></a> </div> <div class="step2"> <div class="vip-payj-left"> <div onclick="checkPay(2)" class="pay-type pay-type-wx active"></div> <div onclick="checkPay(1)" class="pay-type pay-type-ali m-t-xs"></div> <div class="m-t-lg"> <p>1.完成支付后可在我的-我的发票中申请发票</p> <p>2.VIP会员自支付完成之时起5分钟内生效</p> </div> </div> <div class="vip-payj-qrcode"> <div class="wx_pay_box"> <div id="wx_pay_img" class="wx_pay_img"></div> <img class="pay-load" src="/material/theme/chacha/cms/v2/images/preloader.gif"> </div> <div class="ali_pay_box" loading-img="/material/theme/chacha/cms/v2/images/preloader.gif"> <img class="pay-load" src="/material/theme/chacha/cms/v2/images/preloader.gif"> </div> </div> </div> </div> </div> </div> </div> <script type="text/javascript" src="/material/theme/chacha/cms/v2/js/pay.js?time=1562322400"></script> <script type="text/javascript">
    var vipModalTitle;
    var userid = '';
    function showVipModal(title, subTitle, img, linkName, linkUrl, isStep2){
        if(!userid){
            getCaptcha();
            $('#loginModal').modal('show');
            return;
        }
        $("#vipModal .step1").show();
        $("#vipModal .step2").hide();
        if(title){
            $('#vipModal .vip-title .title').text(title);
            //vipModalTitle = title;
        }
        if(subTitle){
            $('#vipModal .vip-title .sub-title span').text(subTitle);
        }
        if(img){
            if(title == '风险监控'){
                var imgUrl = "/material/theme/chacha/cms/v2/images/vip/ldjk.png";
                $("#vipModal .demo-img").attr("src",imgUrl);
            } else {
                var imgUrl = "/material/theme/chacha/cms/v2/images/vip/"+img+".png";
                $("#vipModal .demo-img").attr("src",imgUrl);
            }
        } else {
            var imgUrl = "/material/theme/chacha/cms/v2/images/vip/default.png";
            $("#vipModal .demo-img").attr("src",imgUrl);
        }
        if(linkName && linkUrl){
            $("#vipModal .vip-demo-link").show();
            $("#vipModal .vip-demo-link").text(linkName + '>');
            $("#vipModal .vip-demo-link").attr('href',linkUrl);
        } else {
            $("#vipModal .vip-demo-link").hide();
        }
        /*if(isStep2){
            $("#vipModal .step1").hide();
            $("#vipModal .step2").show();
            strartBuy();
        }*/
        $('#vipModal').modal('show');
        // 嵌入的关闭
        $(".vip-insert-wrap .step1").show();
        $(".vip-insert-wrap .step2").hide();
    }
    $('#vipModal').on('hide.bs.modal',function(){
        clearPay();
        isPayShow = false;
    })
    function modalJumpVip(){
        isPayShow = true;
        strartBuy();
        $("#vipModal .step1").hide();
        $("#vipModal .step2").show();
        /*yaojie old
        location.href = INDEX_URL+'/vip?goods_id='+$("input[name='goods_id']").val();
        if(vipModalTitle){
            //zhugeTrack(vipModalTitle.split(' ')[0]+'-开通VIP');
        }else{
            //zhugeTrack('VIP弹框-开通VIP');
        }*/
    }
    var isPayShow = false;
    var wxOrderStatus = 0;
    var wxOrderCode = '';
    var wxpayLoad = false;
    var alipayLoad = false;
    var cPayType = 2;
    var isModalShow = true;
    var cGoods_id = "17";
    var cYear = "3";
    var cPrice = "720";
    $('#vipModal .vip-year-list .vip-kuang').on('click',function(){
        changeYear($(this).attr('data-id'),$(this).attr('data-year'),$(this).attr('data-price'),this);
        var couponCode = $("#vipModal input[name='coupon_code']").val();
        if(couponCode == ''){
            //checkPay(cPayType);
        }
    });
    var siModel = null;
    function strartBuy(){
        if(typeof siModel != 'undefined' && siModel){
            clearInterval(siModel);
            siModel = null;
        }
        if(typeof siInsert != 'undefined' && siInsert){
            clearInterval(siInsert);
            siInsert = null;
        }
        siModel = setInterval(function(){
            getWxPayStatus();
        }, 3000);
        //checkPay(cPayType);
        setTimeout(function() {
            getcouponlist(cGoods_id);
        }, 300);
    }
</script> </body> </html>
